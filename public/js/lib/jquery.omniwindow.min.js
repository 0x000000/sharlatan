(function(d){d.fn.extend({omniWindow:function(b){var b=d.extend(!0,{animationsPriority:{show:["overlay","modal"],hide:["modal","overlay"]},overlay:{selector:".ow-overlay",hideClass:"ow-closed",animations:{show:function(a,b){return b(a)},hide:function(a,b){return b(a)},internal:{show:function(a){a.overlay.removeClass(b.overlay.hideClass)},hide:function(a){a.overlay.addClass(b.overlay.hideClass)}}}},modal:{hideClass:"ow-closed",animations:{show:function(a,b){return b(a)},hide:function(a,b){return b(a)},
    internal:{show:function(a){a.modal.removeClass(b.modal.hideClass)},hide:function(a){a.modal.addClass(b.modal.hideClass)}}},internal:{stateAttribute:"ow-active"}},eventsNames:{show:"show.ow",hide:"hide.ow",internal:{overlayClick:"click.ow",keyboardKeyUp:"keyup.ow"}},callbacks:{beforeShow:function(a,b){return b(a)},positioning:function(a,b){return b(a)},afterShow:function(a,b){return b(a)},beforeHide:function(a,b){return b(a)},afterHide:function(a,b){return b(a)},internal:{beforeShow:function(a){if(a.modal.data(b.modal.internal.stateAttribute))return false;
    a.modal.data(b.modal.internal.stateAttribute,true);return true},afterShow:function(a){d(document).on(b.eventsNames.internal.keyboardKeyUp,function(c){c.keyCode==27&&a.modal.trigger(b.eventsNames.hide)});a.overlay.on(b.eventsNames.internal.overlayClick,function(){a.modal.trigger(b.eventsNames.hide)})},positioning:function(a){a.modal.css("margin-left",Math.round(a.modal.outerWidth()/-2))},beforeHide:function(a){if(a.modal.data(b.modal.internal.stateAttribute)){a.modal.data(b.modal.internal.stateAttribute,
    false);return true}return false},afterHide:function(a){a.overlay.off(b.eventsNames.internal.overlayClick);d(document).off(b.eventsNames.internal.keyboardKeyUp);a.overlay.css("display","");a.modal.css("display","")}}}},b),e=function(a,c,d){var e=b.animationsPriority[a][0],g=b.animationsPriority[a][1];b[e].animations[a](c,function(f){b[e].animations.internal[a](f);b[g].animations[a](c,function(e){b[g].animations.internal[a](e);b.callbacks[d](c,b.callbacks.internal[d])})})},f=d(b.overlay.selector);return this.each(function(){var a=
    d(this),c={modal:a,overlay:f};a.bind(b.eventsNames.show,function(){b.callbacks.beforeShow(c,b.callbacks.internal.beforeShow)&&(b.callbacks.positioning(c,b.callbacks.internal.positioning),e("show",c,"afterShow"))}).bind(b.eventsNames.hide,function(){b.callbacks.beforeHide(c,b.callbacks.internal.beforeHide)&&e("hide",c,"afterHide")})})}})})(jQuery);